# Story 1.5: DirectDrive Content-Citation-Performance Loop Monitoring

## Status
Ready for Implementation

## Story
**As a** DirectDrive business owner,
**I want** to monitor and correlate published content performance with AI citation improvements,
**so that** I can measure ROI and optimize content strategy for maximum AI visibility impact.

## Acceptance Criteria
1. Multi-factor content matching system verifies published content via URL tracking, title+date correlation, keyword fingerprint analysis, and content similarity scoring (>85% confidence threshold)
2. Website verification system performs daily crawling of directdrivelogistic.com/blog/ to detect new content publication and track availability status
3. 12-week attribution tracking timeline implemented with three phases: 0-4 weeks baseline establishment, 4-8 weeks primary impact measurement, 8-12 weeks sustained impact analysis
4. Performance metrics dashboard tracks citation lift >50%, time to first citation <14 days, and attribution confidence >85% for published content pieces
5. ROI analysis system correlates published content pieces with AI citation frequency improvements and calculates content effectiveness scores
6. Integration with existing content_pieces table and citation monitoring system enables automated performance correlation and attribution reporting

## Tasks / Subtasks

- [ ] Task 1: Implement Content Verification and Tracking System (AC: 1, 2)
  - [ ] Create web crawler service for directdrivelogistic.com/blog/ monitoring
  - [ ] Implement multi-factor content matching algorithms (URL, title+date, keyword fingerprint, similarity scoring)
  - [ ] Build content verification database schema extending content_pieces table
  - [ ] Add content publication status tracking and availability monitoring
  - [ ] Implement confidence scoring system with >85% threshold validation

- [ ] Task 2: Build 12-Week Attribution Timeline System (AC: 3, 4)
  - [ ] Create attribution phases data model (baseline, primary, sustained)
  - [ ] Implement timeline tracking system with automated phase transitions
  - [ ] Build performance metrics calculation engine (citation lift, time to first citation)
  - [ ] Add attribution confidence calculation with >85% confidence requirement
  - [ ] Create automated reporting system for each attribution phase

- [ ] Task 3: Develop ROI Analysis and Correlation Engine (AC: 5, 6)
  - [ ] Build content-citation correlation algorithms linking published pieces to citation improvements
  - [ ] Implement ROI calculation system measuring content effectiveness scores
  - [ ] Create performance correlation analytics comparing before/after publication metrics
  - [ ] Add competitive impact analysis showing market position improvements
  - [ ] Build automated attribution reporting with business impact metrics

- [ ] Task 4: Integrate with Existing Citation Monitoring System (AC: 6)
  - [ ] Extend ai_citations table to include content correlation fields
  - [ ] Integrate with existing citation monitoring workflow from Story 1.4
  - [ ] Create unified data pipeline linking content_pieces and ai_citations tables
  - [ ] Add real-time correlation updates using Supabase Realtime
  - [ ] Implement cross-system data validation and consistency checks

- [ ] Task 5: Build Performance Monitoring Dashboard (AC: 3, 4, 5)
  - [ ] Create content-citation correlation dashboard with attribution timeline visualization
  - [ ] Build ROI analysis charts showing content effectiveness and business impact
  - [ ] Implement real-time performance tracking with citation lift metrics
  - [ ] Add content attribution confidence indicators and validation status
  - [ ] Create automated alerts for significant performance improvements or issues

- [ ] Task 6: Testing and Validation (All ACs)
  - [ ] Unit tests for content verification algorithms and correlation logic
  - [ ] Integration tests for complete content-citation-performance tracking workflow
  - [ ] Performance tests for 12-week attribution tracking and ROI calculation
  - [ ] End-to-end tests with real DirectDrive content and citation monitoring
  - [ ] Validation tests for attribution confidence and correlation accuracy

## Dev Notes

### Previous Story Dependencies
From Stories 1.1-1.4 completion:
- Complete Supabase database setup with DirectDrive logistics schema (Story 1.1)
- Operational n8n workflow system for content automation (Story 1.2)
- DirectDrive logistics content specialization and publishing pipeline (Story 1.3)
- AI citation monitoring system with daily tracking and competitive analysis (Story 1.4)

### Data Models
**ContentPerformance Interface**:
```typescript
interface ContentPerformance {
  id: number;
  content_id: number; // FK to content_pieces
  verification_status: 'pending' | 'verified' | 'not_found' | 'error';
  publication_url?: string;
  verification_confidence: number; // 0-100%
  attribution_phase: 'baseline' | 'primary' | 'sustained' | 'completed';
  citation_baseline_count: number;
  citation_current_count: number;
  citation_lift_percentage: number;
  time_to_first_citation?: number; // days
  roi_score: number; // calculated effectiveness score
  tracking_start_date: string;
  last_verified_at: string;
}
```

**ContentVerification Interface**:
```typescript
interface ContentVerification {
  id: number;
  content_id: number;
  verification_method: 'url_tracking' | 'title_date' | 'keyword_fingerprint' | 'content_similarity';
  match_confidence: number; // 0-100%
  verification_details: object; // method-specific matching data
  verified_at: string;
}
```

**AttributionTimeline Interface**:
```typescript
interface AttributionTimeline {
  id: number;
  content_id: number;
  phase: 'baseline' | 'primary' | 'sustained';
  phase_start_date: string;
  phase_end_date: string;
  citation_count_start: number;
  citation_count_end: number;
  performance_metrics: object; // phase-specific metrics
  attribution_confidence: number; // 0-100%
}
```

### API Specifications
**Content Performance Monitoring Endpoints**:

1. **POST /api/v1/content/verify**
   - Body: `{ content_id: number, publication_url?: string }`
   - Response: `{ verification: ContentVerification, confidence: number, success: boolean }`

2. **GET /api/v1/content/performance**
   - Query params: content_id?, phase?, date_from?, date_to?
   - Response: `{ performances: ContentPerformance[], attribution_summary: AttributionSummary }`

3. **GET /api/v1/content/roi-analysis**
   - Query params: timeframe: string, content_ids?: number[]
   - Response: `{ roi_metrics: ROIMetrics, content_effectiveness: ContentEffectiveness[], business_impact: BusinessImpact }`

4. **POST /api/v1/content/attribution/update**
   - Body: `{ content_id: number, citation_data: CitationUpdate }`
   - Response: `{ attribution: AttributionTimeline, correlation_updated: boolean }`

### Component Specifications
**Performance Monitoring Dashboard**:
- Content Attribution Timeline: 12-week phase visualization with citation correlation
- ROI Analysis Charts: Content effectiveness scores and business impact metrics
- Real-time Performance Tracking: Live citation lift and attribution confidence
- Content Verification Status: Multi-factor matching confidence and publication verification

### File Locations
Based on project structure:
- Web crawler service: `packages/content-crawler/src/crawler/`
- Content verification logic: `packages/shared/src/utils/content-verification.ts`
- Attribution tracking: `packages/shared/src/utils/attribution-timeline.ts`
- ROI analysis engine: `packages/shared/src/utils/roi-analysis.ts`
- API routes: `apps/dashboard/src/pages/api/v1/content/`
- Dashboard components: `apps/dashboard/src/components/performance/`
- Database schema: `database/content_performance_schema.sql`

### Technical Constraints
**Performance Requirements**:
- Content verification API response time < 300ms
- Daily website crawling execution < 2 minutes
- Attribution correlation calculation < 5 seconds per content piece
- Support for 500+ published content pieces tracking simultaneously

**Accuracy Requirements**:
- Content matching confidence threshold: >85%
- Attribution confidence threshold: >85%
- Citation lift measurement accuracy: Â±5%
- ROI calculation precision: 2 decimal places

**Business Constraints**:
- 12-week attribution timeline must align with DirectDrive business cycles
- Performance metrics must demonstrate clear ROI for content investment
- Integration must not impact existing citation monitoring system performance
- Dashboard must provide actionable insights for content strategy optimization

### Integration Dependencies
**Story 1.4 Citation Monitoring System**:
- Extends ai_citations table with content correlation fields
- Integrates with existing n8n citation monitoring workflow
- Uses established AI model monitoring infrastructure
- Leverages competitive analysis capabilities for attribution validation

**Story 1.3 Content Generation System**:
- Links with content_pieces table for published content tracking
- Extends content workflow to include performance monitoring triggers
- Uses established DirectDrive logistics content categorization
- Integrates with content quality and SEO optimization metrics

### Testing Strategy
**Content Verification Testing**:
- Test multi-factor matching algorithms with real DirectDrive content
- Validate confidence scoring accuracy with manual verification samples
- Test website crawler reliability and error handling
- Verify content similarity algorithms with published/unpublished content pairs

**Attribution Timeline Testing**:
- Test 12-week phase transitions with accelerated timeline simulation
- Validate citation correlation accuracy with known publication events
- Test attribution confidence calculation with various citation patterns
- Verify ROI calculation accuracy with business impact data

**Integration Testing**:
- End-to-end workflow testing from content publication to ROI analysis
- Cross-system data consistency validation between content and citation systems
- Real-time correlation testing with Supabase Realtime subscriptions
- Performance testing under high content volume and citation frequency

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-15 | 1.0 | Initial story creation for Content-Citation-Performance Loop Monitoring | Project Manager Agent |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Implementation Notes
This story represents a significant pivot from WordPress API automation to performance correlation analysis. The new approach:

**Eliminates Risk Factors**:
- WordPress API dependency and potential publishing failures
- Manual content management and tracking inconsistencies
- Limited visibility into content ROI and business impact

**Adds Strategic Value**:
- Quantifiable content performance measurement with 12-week attribution timeline
- Multi-factor content verification ensuring accurate correlation analysis
- ROI analysis system providing actionable business insights for content strategy

**Technical Innovation**:
- Advanced content matching algorithms with >85% confidence requirements
- Automated website crawling for real-time publication status tracking
- Sophisticated attribution modeling correlating content with AI citation improvements

### Completion Dependencies
This story completion depends on:
- Stories 1.1-1.4 providing established database schema, content generation, and citation monitoring infrastructure
- Integration with existing content_pieces and ai_citations tables from previous stories
- Operational n8n workflow system and Supabase database from foundation stories

## QA Results
*This section will be populated by the QA Agent after story completion*